<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CP Master - Competitive Programming Editor</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body { background-color: #f4f6f9; color: #1f2d3d; transition: background 0.3s, color 0.3s; }
  .dark-mode { background-color: #1e1e1e; color: white; }
  #editor { height: 500px; border: 1px solid #444; border-radius: 4px; }
  .nav-item { cursor: pointer; }
  .card { background: white; border-radius: 8px; box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2); }
  .dark-mode .card { background: #343a40; }
  .panel-title {
    text-align: center;
    font-size: 1.25rem;
    font-weight: bold;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
    border-bottom: 2px solid rgba(0,0,0,0.1);
    color: #007bff;
  }
  .dark-mode .panel-title { color: #3f8dfd; }
  .code-templates { max-height: 300px; overflow-y: auto; }
  .template-item { cursor: pointer; transition: all 0.3s; }
  .template-item:hover { background: #f8f9fa; }
  .dark-mode .template-item:hover { background: #454d55; }
  .timer { font-family: monospace; font-size: 1.5rem; }
  .problem-tags span { 
    display: inline-block;
    padding: 2px 8px;
    margin: 2px;
    border-radius: 12px;
    background: #e9ecef;
    font-size: 0.85rem;
  }
  .dark-mode .problem-tags span { background: #454d55; }
</style>
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
    </ul>
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <button id="themeToggle" class="btn btn-default">
          <i class="fas fa-moon"></i>
        </button>
      </li>
      <li class="nav-item ml-2">
        <div class="timer">00:00:00</div>
      </li>
    </ul>
  </nav>

  <!-- Main Sidebar -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <a href="#" class="brand-link">
      <span class="brand-text font-weight-light">CP Master</span>
    </a>
    <div class="sidebar">
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu">
          <li class="nav-item">
            <a href="#" class="nav-link active" data-section="editor">
              <i class="nav-icon fas fa-code"></i>
              <p>Code Editor</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-section="tutorials">
              <i class="nav-icon fas fa-graduation-cap"></i>
              <p>Tutorials</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-section="templates">
              <i class="nav-icon fas fa-file-code"></i>
              <p>Code Templates</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-section="practice">
              <i class="nav-icon fas fa-dumbbell"></i>
              <p>Practice</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-section="solutions">
              <i class="nav-icon fas fa-save"></i>
              <p>Saved Solutions</p>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </aside>

  <!-- Content -->
  <div class="content-wrapper">
    <section class="content pt-4">
      <div class="container-fluid">
        <div class="row">
          <!-- Problem statement -->
          <div class="col-md-4">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Problem Statement</h3>
                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="maximize">
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>
              <div class="card-body p-0">
                <textarea id="problem" class="form-control border-0" style="height: 500px; resize: none;" placeholder="Paste your problem statement here..."></textarea>
                <div class="problem-tags p-2">
                  <span>Dynamic Programming</span>
                  <span>Graph Theory</span>
                  <span>Data Structures</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Editor Section -->
          <div class="col-md-5">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Code Editor</h3>
                <div class="card-tools">
                  <div class="btn-group">
                    <button type="button" id="templateBtn" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
                      <i class="fas fa-file-code"></i> Templates
                    </button>
                    <div class="dropdown-menu dropdown-menu-right code-templates">
                      <a class="dropdown-item template-item">Basic Template</a>
                      <a class="dropdown-item template-item">Graph Algorithms</a>
                      <a class="dropdown-item template-item">Dynamic Programming</a>
                      <a class="dropdown-item template-item">Data Structures</a>
                    </div>
                  </div>
                  <button type="button" class="btn btn-tool" data-card-widget="maximize">
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>
              <div class="card-body p-0">
                <div id="editor"></div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-md-6">
                    <textarea id="input" class="form-control" rows="4" placeholder="Custom test cases..."></textarea>
                  </div>
                  <div class="col-md-6">
                    <pre id="output" class="form-control" style="height: 96px; overflow-y: auto;">Output will appear here...</pre>
                  </div>
                </div>
                <div class="mt-3">
                  <button id="runBtn" class="btn btn-primary">
                    <i class="fas fa-play"></i> Run Code
                  </button>
                  <button id="saveBtn" class="btn btn-success">
                    <i class="fas fa-save"></i> Save Solution
                  </button>
                  <button id="formatBtn" class="btn btn-info">
                    <i class="fas fa-align-left"></i> Format Code
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Solutions Section -->
          <div class="col-md-3">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Saved Solutions</h3>
                <div class="card-tools">
                  <div class="input-group input-group-sm" style="width: 150px;">
                    <input type="text" id="solutionSearch" class="form-control" placeholder="Search solutions...">
                    <div class="input-group-append">
                      <button type="button" class="btn btn-default">
                        <i class="fas fa-search"></i>
                      </button>
                    </div>
                  </div>
                  <button type="button" class="btn btn-tool ml-2" data-card-widget="maximize">
                    <i class="fas fa-expand"></i>
                  </button>
                </div>
              </div>
              <div class="card-body p-0">
                <div class="list-group list-group-flush" id="solutionList">
                  <!-- Solutions will be populated here -->
                </div>
              </div>
              <div class="card-footer">
                <div class="d-flex justify-content-between align-items-center">
                  <small><span id="solutionCount">0</span> solutions</small>
                  <div class="btn-group">
                    <button class="btn btn-sm btn-default" id="exportBtn">
                      <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-sm btn-default" id="importBtn">
                      <i class="fas fa-upload"></i> Import
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Statistics Section -->
        <div class="row mt-4">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Performance Statistics</h3>
                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                </div>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-3">
                    <div class="info-box bg-info">
                      <span class="info-box-icon"><i class="fas fa-code"></i></span>
                      <div class="info-box-content">
                        <span class="info-box-text">Total Problems</span>
                        <span class="info-box-number" id="totalProblems">0</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="info-box bg-success">
                      <span class="info-box-icon"><i class="fas fa-clock"></i></span>
                      <div class="info-box-content">
                        <span class="info-box-text">Avg. Solve Time</span>
                        <span class="info-box-number" id="avgSolveTime">0:00</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="info-box bg-warning">
                      <span class="info-box-icon"><i class="fas fa-tags"></i></span>
                      <div class="info-box-content">
                        <span class="info-box-text">Most Used Tags</span>
                        <span class="info-box-number" id="topTags">-</span>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="info-box bg-danger">
                      <span class="info-box-icon"><i class="fas fa-chart-line"></i></span>
                      <div class="info-box-content">
                        <span class="info-box-text">Weekly Progress</span>
                        <span class="info-box-number" id="weeklyProgress">0</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mt-4">
                  <div class="col-md-6">
                    <canvas id="problemsChart"></canvas>
                  </div>
                  <div class="col-md-6">
                    <canvas id="tagsChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tutorials Section -->
        <div class="row mt-4 d-none" id="tutorialsSection">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Interactive C++ Tutorials</h3>
                <div class="card-tools">
                  <div class="input-group input-group-sm" style="width: 150px;">
                    <input type="text" id="tutorialSearch" class="form-control" placeholder="Search tutorials...">
                    <div class="input-group-append">
                      <button type="button" class="btn btn-default">
                        <i class="fas fa-search"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-3">
                    <div class="nav flex-column nav-pills" id="tutorialTabs">
                      <a class="nav-link active" data-toggle="pill" href="#basicsTutorial">
                        <i class="fas fa-code mr-2"></i>C++ Basics
                        <span class="badge badge-success float-right">Beginner</span>
                      </a>
                      <a class="nav-link" data-toggle="pill" href="#stlTutorial">
                        <i class="fas fa-box mr-2"></i>STL
                        <span class="badge badge-info float-right">Intermediate</span>
                      </a>
                      <a class="nav-link" data-toggle="pill" href="#algorithmsTutorial">
                        <i class="fas fa-microchip mr-2"></i>Algorithms
                        <span class="badge badge-warning float-right">Advanced</span>
                      </a>
                      <a class="nav-link" data-toggle="pill" href="#dsTutorial">
                        <i class="fas fa-tree mr-2"></i>Data Structures
                        <span class="badge badge-danger float-right">Advanced</span>
                      </a>
                    </div>
                    <div class="progress mt-3" style="height: 20px;">
                      <div class="progress-bar progress-bar-striped" id="tutorialProgress" role="progressbar" style="width: 0%">0%</div>
                    </div>
                  </div>
                  <div class="col-md-9">
                    <div class="tab-content" id="tutorialContent">
                      <!-- C++ Basics -->
                      <div class="tab-pane fade show active" id="basicsTutorial">
                        <div class="tutorial-step" data-step="1">
                          <h4>1. Introduction to C++</h4>
                          <div class="tutorial-content">
                            <pre class="bg-light p-3 mb-3">#include &lt;iostream&gt;
using namespace std;

int main() {
    cout << "Hello, Competitive Programming!" << endl;
    return 0;
}</pre>
                            <p>This is a basic C++ program that prints a message. Let's understand each part:</p>
                            <ul class="list-group">
                              <li class="list-group-item"><code>#include &lt;iostream&gt;</code> - Header file for input/output</li>
                              <li class="list-group-item"><code>using namespace std;</code> - Using standard namespace</li>
                              <li class="list-group-item"><code>int main()</code> - Main function, program entry point</li>
                              <li class="list-group-item"><code>cout</code> - Output stream object</li>
                            </ul>
                            <div class="mt-3">
                              <button class="btn btn-success btn-sm tryCodeBtn">Try it yourself</button>
                              <button class="btn btn-info btn-sm nextStepBtn">Next Step</button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- STL Tutorial -->
                      <div class="tab-pane fade" id="stlTutorial">
                        <div class="tutorial-step" data-step="1">
                          <h4>1. Vectors in C++</h4>
                          <div class="tutorial-content">
                            <pre class="bg-light p-3 mb-3">#include &lt;vector&gt;

vector&lt;int&gt; v = {1, 2, 3};
v.push_back(4);    // Add element
v.pop_back();      // Remove last element
sort(v.begin(), v.end());  // Sort vector</pre>
                            <div class="alert alert-info">
                              <i class="fas fa-info-circle"></i>
                              Vectors are dynamic arrays that can grow or shrink in size.
                            </div>
                            <button class="btn btn-success btn-sm tryCodeBtn">Try it yourself</button>
                          </div>
                        </div>
                      </div>

                      <!-- More tutorial tabs -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <i class="fas fa-clock"></i>
                    Time spent: <span id="tutorialTimer">00:00:00</span>
                  </div>
                  <div>
                    <span class="badge badge-success">
                      <i class="fas fa-check"></i>
                      Completed: <span id="completedTutorials">0</span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Practice Section -->
        <div class="row mt-4 d-none" id="practiceSection">
          <div class="col-12">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Practice Problems</h3>
                <div class="card-tools">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-default" data-difficulty="easy">Easy</button>
                    <button class="btn btn-sm btn-default" data-difficulty="medium">Medium</button>
                    <button class="btn btn-sm btn-default" data-difficulty="hard">Hard</button>
                  </div>
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover" id="practiceTable">
                    <thead>
                      <tr>
                        <th>Problem</th>
                        <th>Difficulty</th>
                        <th>Tags</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- Practice problems will be loaded here -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs/loader.min.js"></script>
<script>
  // Theme Toggle
  document.getElementById("themeToggle").addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    const icon = document.querySelector("#themeToggle i");
    icon.classList.toggle("fa-moon");
    icon.classList.toggle("fa-sun");
    updateEditorTheme();
  });

  // Navigation and Section Management
  const sections = ['editor', 'tutorials', 'templates', 'practice'];
  document.querySelectorAll('.nav-link[data-section]').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      link.classList.add('active');
      
      // Show/hide sections
      sections.forEach(section => {
        const sectionEl = document.getElementById(section + 'Section');
        if (sectionEl) {
          if (link.dataset.section === section) {
            sectionEl.classList.remove('d-none');
          } else {
            sectionEl.classList.add('d-none');
          }
        }
      });

      // Initialize section specific features
      if (link.dataset.section === 'tutorials') {
        initializeTutorials();
      } else if (link.dataset.section === 'practice') {
        loadPracticeProblems();
      }
    });
  });

  // Tutorials System
  let tutorialProgress = {};
  let tutorialTimer = null;
  let tutorialTimeSpent = 0;

  function initializeTutorials() {
    // Load saved progress
    tutorialProgress = JSON.parse(localStorage.getItem('tutorialProgress') || '{}');
    updateTutorialProgress();
    
    // Start timer
    if (tutorialTimer) clearInterval(tutorialTimer);
    tutorialTimer = setInterval(updateTutorialTimer, 1000);

    // Initialize tutorial interactions
    document.querySelectorAll('.tryCodeBtn').forEach(btn => {
      btn.onclick = function() {
        const code = this.parentElement.previousElementSibling.querySelector('pre').textContent;
        window.editor.setValue(code);
        document.querySelector('.nav-link[data-section="editor"]').click();
      };
    });

    document.querySelectorAll('.nextStepBtn').forEach(btn => {
      btn.onclick = function() {
        const currentStep = this.closest('.tutorial-step');
        const nextStep = currentStep.nextElementSibling;
        if (nextStep && nextStep.classList.contains('tutorial-step')) {
          currentStep.style.display = 'none';
          nextStep.style.display = 'block';
          markTutorialComplete(currentStep.dataset.step);
        }
      };
    });

    // Tutorial search functionality
    document.getElementById('tutorialSearch').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      document.querySelectorAll('#tutorialTabs .nav-link').forEach(link => {
        const text = link.textContent.toLowerCase();
        link.style.display = text.includes(searchTerm) ? '' : 'none';
      });
    });
  }

  function markTutorialComplete(step) {
    const tutorialId = document.querySelector('#tutorialContent .tab-pane.active').id;
    if (!tutorialProgress[tutorialId]) {
      tutorialProgress[tutorialId] = new Set();
    }
    tutorialProgress[tutorialId].add(step);
    localStorage.setItem('tutorialProgress', JSON.stringify(tutorialProgress));
    updateTutorialProgress();
  }

  function updateTutorialProgress() {
    const totalSteps = document.querySelectorAll('.tutorial-step').length;
    let completedSteps = 0;
    Object.values(tutorialProgress).forEach(steps => {
      completedSteps += steps.size;
    });
    
    const progressPercent = Math.round((completedSteps / totalSteps) * 100);
    const progressBar = document.getElementById('tutorialProgress');
    progressBar.style.width = `${progressPercent}%`;
    progressBar.textContent = `${progressPercent}%`;
    
    document.getElementById('completedTutorials').textContent = completedSteps;
  }

  function updateTutorialTimer() {
    tutorialTimeSpent++;
    const hours = Math.floor(tutorialTimeSpent / 3600);
    const minutes = Math.floor((tutorialTimeSpent % 3600) / 60);
    const seconds = tutorialTimeSpent % 60;
    document.getElementById('tutorialTimer').textContent = 
      `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
  }

  // Practice Problems System
  const practiceProblems = [
    {
      id: 1,
      title: "Sum of Two Numbers",
      difficulty: "easy",
      tags: ["implementation", "math"],
      description: "Write a program to find the sum of two integers.",
      template: `#include <iostream>
using namespace std;

int main() {
    int a, b;
    cin >> a >> b;
    // Your code here
    return 0;
}`
    },
    {
      id: 2,
      title: "Binary Search Implementation",
      difficulty: "medium",
      tags: ["binary search", "arrays"],
      description: "Implement binary search algorithm.",
      template: `#include <vector>
using namespace std;

int binarySearch(vector<int>& arr, int target) {
    // Your code here
}`
    }
    // Add more practice problems here
  ];

  function loadPracticeProblems(difficulty = null) {
    const tbody = document.querySelector('#practiceTable tbody');
    tbody.innerHTML = '';
    
    const problems = difficulty ? 
      practiceProblems.filter(p => p.difficulty === difficulty) : 
      practiceProblems;

    problems.forEach(problem => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${problem.title}</td>
        <td><span class="badge badge-${getDifficultyBadge(problem.difficulty)}">${problem.difficulty}</span></td>
        <td>${problem.tags.map(tag => `<span class="badge badge-info mr-1">${tag}</span>`).join('')}</td>
        <td id="status-${problem.id}">Not attempted</td>
        <td>
          <button class="btn btn-sm btn-primary" onclick="loadPracticeProblem(${problem.id})">
            <i class="fas fa-code"></i> Solve
          </button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  function getDifficultyBadge(difficulty) {
    return {
      easy: 'success',
      medium: 'warning',
      hard: 'danger'
    }[difficulty] || 'info';
  }

  function loadPracticeProblem(id) {
    const problem = practiceProblems.find(p => p.id === id);
    if (problem) {
      document.getElementById('problem').value = problem.description;
      window.editor.setValue(problem.template);
      document.querySelector('.nav-link[data-section="editor"]').click();
    }
  }

  // Initialize practice problem difficulty filters
  document.querySelectorAll('.btn[data-difficulty]').forEach(btn => {
    btn.addEventListener('click', () => {
      loadPracticeProblems(btn.dataset.difficulty);
    });
  });

  // Timer
  function updateTimer() {
    const timerEl = document.querySelector('.timer');
    let [hours, minutes, seconds] = timerEl.textContent.split(':').map(Number);
    seconds++;
    if (seconds === 60) {
      seconds = 0;
      minutes++;
      if (minutes === 60) {
        minutes = 0;
        hours++;
      }
    }
    timerEl.textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
  }
  setInterval(updateTimer, 1000);

  // Code Templates
  const templates = {
    'Basic Template': `#include <bits/stdc++.h>
using namespace std;

void solve() {
    // Your solution here
}

int main() {
    ios::sync_with_stdio(0);
    cin.tie(0);
    
    int t = 1;
    cin >> t;
    while(t--) solve();
    
    return 0;
}`,
    'Graph Algorithms': `#include <bits/stdc++.h>
using namespace std;

class Graph {
    vector<vector<int>> adj;
    int V;
public:
    Graph(int v) : V(v) {
        adj.resize(V);
    }
    
    void addEdge(int u, int v) {
        adj[u].push_back(v);
    }
    
    vector<bool> visited;
    void dfs(int v) {
        visited[v] = true;
        for(int u : adj[v]) {
            if(!visited[u])
                dfs(u);
        }
    }
};

int main() {
    // Your graph solution here
    return 0;
}`
  };

  // Monaco Editor
  require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs' }});
  require(["vs/editor/editor.main"], function () {
    window.editor = monaco.editor.create(document.getElementById('editor'), {
      value: templates['Basic Template'],
      language: "cpp",
      theme: "vs-dark",
      automaticLayout: true,
      minimap: { enabled: true },
      fontSize: 14,
      lineNumbers: 'on',
      renderWhitespace: 'selection',
      tabSize: 4,
      insertSpaces: true
    });
  });

  function updateEditorTheme() {
    if (window.editor) {
      window.editor.updateOptions({
        theme: document.body.classList.contains('dark-mode') ? 'vs-dark' : 'vs'
      });
    }
  }

  // Template Selection
  document.querySelectorAll('.template-item').forEach(item => {
    item.addEventListener('click', () => {
      const templateName = item.textContent;
      if (templates[templateName]) {
        window.editor.setValue(templates[templateName]);
      }
    });
  });

  // Format Code
  document.getElementById('formatBtn').addEventListener('click', () => {
    if (window.editor) {
      window.editor.getAction('editor.action.formatDocument').run();
    }
  });

  // Run Code
  document.getElementById('runBtn').addEventListener('click', async () => {
    const outputEl = document.getElementById('output');
    outputEl.textContent = 'Running...';
    
    try {
      const source_code = window.editor.getValue();
      const stdin = document.getElementById('input').value;
      const response = await fetch("https://judge0-ce.p.rapidapi.com/submissions?base64_encoded=false&wait=true", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-rapidapi-host": "judge0-ce.p.rapidapi.com",
          "x-rapidapi-key": "f5deb01607msh6c40db8f424e01dp14bc48jsnb21a6af4366c"
        },
        body: JSON.stringify({
          source_code,
          language_id: 54, // C++ (GCC 9.2.0)
          stdin
        })
      });
      const result = await response.json();
      outputEl.textContent = result.stdout || result.stderr || result.compile_output || "No output";
    } catch (error) {
      outputEl.textContent = 'Error: ' + error.message;
    }
  });

  // Save Solution
  document.getElementById('saveBtn').addEventListener('click', () => {
    const problem = document.getElementById('problem').value.trim();
    const code = window.editor.getValue().trim();
    if (!problem || !code) return alert("Problem and Code are required!");

    const solutions = JSON.parse(localStorage.getItem('solutions') || "[]");
    const tags = Array.from(document.querySelectorAll('.problem-tags span')).map(span => span.textContent);
    
    solutions.push({ 
      problem, 
      code, 
      date: new Date().toLocaleString(),
      tags,
      timeSpent: document.querySelector('.timer').textContent
    });
    
    localStorage.setItem('solutions', JSON.stringify(solutions));
    loadSolutions();
  });

  // Load Saved Solutions
  function loadSolutions() {
    const list = document.getElementById('solutionList');
    list.innerHTML = "";
    const solutions = JSON.parse(localStorage.getItem('solutions') || "[]");
    
    solutions.forEach((s, i) => {
      const item = document.createElement("div");
      item.className = "list-group-item";
      
      const header = document.createElement("div");
      header.className = "d-flex justify-content-between align-items-center";
      header.innerHTML = `
        <h5 class="mb-1">${s.problem.substring(0, 40)}${s.problem.length > 40 ? '...' : ''}</h5>
        <small>${s.date}</small>
      `;
      
      const body = document.createElement("div");
      body.className = "mb-1";
      body.innerHTML = `
        <div class="text-muted small">Time spent: ${s.timeSpent}</div>
        ${s.tags ? `<div class="problem-tags">${s.tags.map(tag => `<span>${tag}</span>`).join('')}</div>` : ''}
      `;
      
      const actions = document.createElement("div");
      actions.className = "btn-group btn-group-sm";
      actions.innerHTML = `
        <button class="btn btn-info edit-btn"><i class="fas fa-edit"></i> Edit</button>
        <button class="btn btn-success view-btn"><i class="fas fa-eye"></i> View</button>
        <button class="btn btn-danger delete-btn"><i class="fas fa-trash"></i> Delete</button>
      `;
      
      item.appendChild(header);
      item.appendChild(body);
      item.appendChild(actions);
      
      // Event Listeners
      item.querySelector('.edit-btn').addEventListener('click', () => {
        document.getElementById('problem').value = s.problem;
        window.editor.setValue(s.code);
      });
      
      item.querySelector('.delete-btn').addEventListener('click', () => {
        if (confirm("Are you sure you want to delete this solution?")) {
          solutions.splice(i, 1);
          localStorage.setItem('solutions', JSON.stringify(solutions));
          loadSolutions();
        }
      });
      
      list.appendChild(item);
    });
  }

  loadSolutions();

  // Initialize tooltips
  $('[data-toggle="tooltip"]').tooltip();
</script>

<footer class="w-full mt-8 py-4 bg-gray-900 text-center text-gray-300 text-lg font-semibold" style="letter-spacing:1px;">
  Developer: Md Sobuj Mia
</footer>
</script>
</body>
</html>
